(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cd9b4e8"],{6502:function(e,t,n){},"7fcb":function(e,t,n){"use strict";n("9835")},"838f":function(e,t,n){},"90df":function(e,t,n){"use strict";n.r(t);n("b0c0");var s=n("7a23"),c=Object(s["L"])("data-v-52211068");Object(s["w"])("data-v-52211068");var a={style:{"text-align":"left"}},i={class:"panel panel-default"},o={class:"card"},l={style:{margin:"auto",padding:"10px 0px 10px 0"}},r={key:0},d={class:"panel-body msg_container_base",style:{height:"700px"}},u={class:"panel-footer"},b={class:"input-group"},g={class:"input-group-btn"};Object(s["u"])();var h=c((function(e,t,n,c,h,f){var m=Object(s["A"])("MessageSent"),v=Object(s["A"])("MessageRecieved");return Object(s["t"])(),Object(s["e"])("div",a,[Object(s["i"])("div",i,[Object(s["i"])("div",o,[Object(s["i"])("label",l,Object(s["C"])(h.friend.name+" "+h.friend.surname),1),h.disabled?(Object(s["t"])(),Object(s["e"])("label",r,"Aktifleşmesi bekleniyor...")):Object(s["f"])("",!0)]),Object(s["i"])("div",d,[(Object(s["t"])(!0),Object(s["e"])(s["a"],null,Object(s["z"])(h.messages,(function(e){return Object(s["t"])(),Object(s["e"])("div",{key:e},[e.isSent?(Object(s["t"])(),Object(s["e"])(m,{key:0,message:e,me:h.user},null,8,["message","me"])):(Object(s["t"])(),Object(s["e"])(v,{key:1,message:e,friend:h.friend},null,8,["message","friend"]))])})),128))]),Object(s["i"])("div",u,[Object(s["i"])("div",b,[Object(s["I"])(Object(s["i"])("input",{id:"btn-input",type:"text",class:"form-control input-sm chat_input",placeholder:"Write your message here...","onUpdate:modelValue":t[1]||(t[1]=function(e){return h.message=e}),disabled:h.disabled,onKeyup:t[2]||(t[2]=Object(s["J"])((function(){return f.sendMessage&&f.sendMessage.apply(f,arguments)}),["enter"]))},null,40,["disabled"]),[[s["G"],h.message]]),Object(s["i"])("span",g,[Object(s["i"])("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=function(){return f.sendMessage&&f.sendMessage.apply(f,arguments)}),id:"btn-chat"}," Send ")])])])])])})),f=(n("7db0"),Object(s["L"])("data-v-3aa2cc06"));Object(s["w"])("data-v-3aa2cc06");var m={class:"row msg_container base_receive"},v=Object(s["i"])("div",{class:"col-md-2 col-xs-2 avatar",style:{"max-width":"67px"}},[Object(s["i"])("img",{class:"\r\n          avatar avatar-48\r\n          bg-light\r\n          rounded-circle\r\n          text-white\r\n          p-2\r\n          img-responsive\r\n        ",src:"https://raw.githubusercontent.com/twbs/icons/main/icons/person-fill.svg"})],-1),p={class:"col-md-10 col-xs-10"},j={class:"messages msg_receive"},O={class:"row"},_={class:"col-12"};Object(s["u"])();var w=f((function(e,t,n,c,a,i){return Object(s["t"])(),Object(s["e"])("div",m,[v,Object(s["i"])("div",p,[Object(s["i"])("div",j,[Object(s["i"])("div",O,[Object(s["i"])("div",_,[Object(s["i"])("p",null,Object(s["C"])(n.message.message),1)])])])])])})),k={props:{message:Object,friend:Object}};n("96bf");k.render=w,k.__scopeId="data-v-3aa2cc06";var y=k,x=Object(s["L"])("data-v-425c217f");Object(s["w"])("data-v-425c217f");var S={class:"row msg_container base_sent"},I={class:"col-md-10 col-xs-10"},M={class:"messages msg_sent"},C={class:"row"},q={class:"col-12",style:{"text-align":"right"}},F=Object(s["i"])("div",{class:"col-md-2 col-xs-2 avatar",style:{"max-width":"67px"}},[Object(s["i"])("img",{class:"avatar avatar-48 bg-light rounded-circle text-white p-2 img-responsive",src:"https://raw.githubusercontent.com/twbs/icons/main/icons/person-fill.svg"})],-1);Object(s["u"])();var R=x((function(e,t,n,c,a,i){return Object(s["t"])(),Object(s["e"])("div",S,[Object(s["i"])("div",I,[Object(s["i"])("div",M,[Object(s["i"])("div",C,[Object(s["i"])("div",q,[Object(s["i"])("p",null,Object(s["C"])(n.message.message),1)])])])]),F])})),$={props:{message:Object,me:Object}};n("de83");$.render=R,$.__scopeId="data-v-425c217f";var A=$,E={components:{MessageRecieved:y,MessageSent:A},data:function(){return{friend:null,connection:null,user:null,messages:[],message:null,channel:{id:null,user1_id:null,user2_id:null},disabled:!0}},methods:{createRequestForChat:function(e){var t=this;this.$http.request("post","api/v1/channels/"+e,null,!0).then((function(e){console.log(e),t.channel.id=e.data.elements[0],t.channel.user1_id=t.user.id,t.channel.user2_id=t.friend.id}))},getFriendInfo:function(e){this.friend=this.user.friends.find((function(t){return t.id==e}))},getUserInfoFromApi:function(e){var t=this;this.$http.request("get","api/v1/users/"+this.$util.getUserInfo().id,null,!0).then((function(n){t.user=n.data.elements[0],t.getFriendInfo(e),t.createRequestForChat(e)}))},sendMessage:function(){console.log("bu kullanıcı mesajıdır . ",this.message),this.messages.push({isSent:!0,message:this.message}),this.connection.send(this.message),this.message=""},checkRequestForChat:function(){var e=this,t=setInterval((function(){null!=e.channel.id&&e.$http.request("get","api/v1/channels/"+e.channel.id,null,!0).then((function(n){console.log(n),n.data.successfull&&(clearInterval(t),e.disabled=!1,e.webSocketCreater())}))}),3e3)},webSocketCreater:function(){console.log("Starting connection to WebSocket Server");var e=this;e.connection=new WebSocket("ws://localhost:4444"),e.connection.onopen=function(e){console.log(e),console.log("Successfully connected to the echo websocket server...")};var t=e.channel.id+"__-__"+e.channel.user1_id+"__-__"+e.channel.user2_id+"__-__"+localStorage.getItem("token");this.connection.onerror=function(e){console.log("WebSocket Error "+e)},this.connection.onmessage=function(t){console.log("Server: "+t.data),t.data&&"Ping"!=t.data&&e.handleIncomeMessage(t.data)},setTimeout((function(){e.connection.send(t)}),1e3)},handleIncomeMessage:function(e){console.log(e),this.messages.push({isSent:!1,message:e})}},mounted:function(){var e=this.$router.currentRoute.value.query.data;console.log("chat panel ",e),this.getUserInfoFromApi(e),this.disabled=!0,this.checkRequestForChat()},unmounted:function(){this.$http.request("delete","api/v1/channels/"+this.channel.id,null,!0).then((function(e){console.log(e)})),this.connection.send("CLOSED_ME_BYE")}};n("7fcb");E.render=h,E.__scopeId="data-v-52211068";t["default"]=E},"96bf":function(e,t,n){"use strict";n("6502")},9835:function(e,t,n){},de83:function(e,t,n){"use strict";n("838f")}}]);
//# sourceMappingURL=chunk-1cd9b4e8.31de1190.js.map